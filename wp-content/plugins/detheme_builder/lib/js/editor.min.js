jQuery(document).ready(function(e){"use strict";function t(t,i){if(!e.isArray(i)||""==t)return!1;for(var n=i.length,a=0;n>a;a++)if(i[a]==t)return!0;return!1}function i(t){t.preventDefault();var i=e(this),n=i.closest(".field-video"),a=e("a.add_field_video",n),o=a.find("video").data("id"),r=n.find("input").val();r=""==r?new Array:r.split(/,/);for(var l=0;l<r.length;l++)r[l]==o&&r.splice(l,1);a.html(a.attr("title")),n.find("input").val("").trigger("change"),i.hide()}function n(){var t=e(this),i=t.closest(".preview-image"),n=t.closest(".field-image"),a=i.find("img").data("id"),o=n.find("input").val();o=""==o?new Array:o.split(/,/);for(var r=0;r<o.length;r++)o[r]==a&&o.splice(r,1);i.remove(),n.find("input").val(o.join(",")).trigger("change")}function a(t){var i,n=e(t).attr("id"),a=(e(t).closest(".wp-editor-wrap"),t.value);window.tinyMCEPreInit.mceInit[n]=_.extend({},tinyMCEPreInit.mceInit.content,{resize:"vertical",height:200,id:n}),window.tinyMCEPreInit.mceInit[n].plugins=window.tinyMCEPreInit.mceInit[n].plugins.replace(/,?wpfullscreen/,""),_.isUndefined(tinyMCEPreInit.qtInit[n])&&(window.tinyMCEPreInit.qtInit[n]=_.extend({},tinyMCEPreInit.qtInit.replycontent,{id:n})),i=quicktags(window.tinyMCEPreInit.qtInit[n]),QTags._buttonsInit(),window.switchEditors.go(n,"tmce"),a=window.switchEditors.pre_wpautop(a),a=window.switchEditors.wpautop(a),"4"===tinymce.majorVersion?window.tinyMCE.execCommand("mceAddEditor",!0,n):window.tinyMCE.execCommand("mceAddEditor",!0,n),window.tinymce.get(n).setContent(a)}function o(t){var i=e(".render-tag",t),n=new Array;return i.length?(i.each(function(){if(e(this).parent().is(".element-column")&&e(this).is(".open-tag")){var t=e(this).closest(".element-column").data("column"),i=e(this).text();i=i.replace("]",' column="'+t+'"]'),n.push(i)}else{var a=e(this).text();e(this).is(".content-tag")&&(a=window.switchEditors.pre_wpautop(a),a=window.switchEditors.wpautop(a)),n.push(a)}}),n.join("")):""}function r(){var t=e("#content"),i=".dt-editor-work",n="";if(!t.length||!i.length)return!1;n=o(i);var a=t.closest(".wp-editor-wrap");if("undefined"!=typeof tinymce)if(window.switchEditors.go("content","tmce"),a.is(".tmce-active"))try{window.tinymce.get("content").setContent(n)}catch(r){t.val(n)}else try{tinymce.get("content").setContent(n)}catch(r){t.val(n)}else t.val(n)}function l(){e(".dt-editor-work .element-parent").length&&e(".dt-editor-work .element-parent").each(function(){var t=e(this),i=t.data("tag");t.find(".dropable-element").sortable({connectWith:'.element-parent[data-tag="'+i+'"]> .dropable-element',cursor:"move",handle:"> .element-toolbar .element-holder, > .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){return!t.item.is(".element-row")&&t.item.parent().is(".dt-editor-work")?!1:(r(),void 0)},over:function(e,t){return!t.item.is(".element-row")&&t.placeholder.parent().is(".dt-editor-work")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):(t.placeholder.removeClass("sortable-placeholder-hidden"),void 0)}})})}function d(){e(".dt-editor-work .element-container > .dropable-element").sortable({cursor:"move",connectWith:".element-column > .dropable-element,.element-container > .dropable-element,.dt-editor-work",handle:"> .element-toolbar .element-holder, > .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(t.item.is(".element-child,.element-frebase")&&t.item.parent().is(".dt-editor-work"))return!1;var i=t.item.find("> .element-holder.dragger");i.removeClass("dragger").html('<i title="'+C.move_this_element+'" class="flaticon-pointer2"></i>'),r()},over:function(e,t){return t.item.is(".element-child,.element-frebase")&&t.placeholder.parent().is(".dt-editor-work")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):(t.placeholder.removeClass("sortable-placeholder-hidden"),void 0)}})}function s(){var t=e(".dt-editor-work .element-column > .dropable-element");t.sortable({cursor:"move",connectWith:".element-column > .dropable-element,.element-container > .dropable-element",handle:"> .element-toolbar .element-holder, > .element-holder,> .inside_row > .element-toolbar .element-holder",tolerance:"pointer",forcePlaceholderSize:!0,start:function(){},stop:function(e,t){if(!t.item.is(".element-row")&&t.item.parent().is(".dt-editor-work"))return!1;if(t.item.is(".element-row"))c(t.item);else{var i=t.item.find("> .element-holder.dragger");i.removeClass("dragger").html('<i title="'+C.move_this_element+'" class="flaticon-pointer2"></i>')}r()},over:function(e,t){return!t.item.is(".element-row")&&t.placeholder.parent().is(".dt-editor-work")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):(t.placeholder.removeClass("sortable-placeholder-hidden"),void 0)}})}function c(e){if(e.closest(".element-column").length){var t=e.closest(".element-column");if(t.is('[data-tag="dt_column"]')){var i=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column"),n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag");n=n.html().replace("dt_inner_row_1","dt_row").replace("dt_row","dt_inner_row");var a=i.find(">.open-tag.render-tag").html().replace("dt_inner_column_1","dt_column").replace("dt_column","dt_inner_column");e.attr("data-tag","dt_inner_row"),e.data("tag","dt_inner_row"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/dt_inner_row]"),e.find("> .inside_row >.open-tag.render-tag").html(n)):(e.find(">.close-tag.render-tag").html("[/dt_inner_row]"),e.find(">.open-tag.render-tag").html(n)),i.attr("data-tag","dt_inner_column"),i.data("tag","dt_inner_column"),i.find(">.close-tag.render-tag").html("[/dt_inner_column]"),i.find(">.open-tag.render-tag").html(a);var o=i.find(">.element-content >.element-row");o.length&&c(o)}else{if(!t.is('[data-tag="dt_inner_column"]'))return e.appendTo(".dt-editor-work"),c(e),!1;var i=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column"),n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag");n=n.html().replace("dt_inner_row_1","dt_row").replace("dt_row","dt_inner_row").replace("dt_inner_row","dt_inner_row_1");var a=i.find(">.open-tag.render-tag").html().replace("dt_inner_column_1","dt_column").replace("dt_column","dt_inner_column").replace("dt_inner_column","dt_inner_column_1");e.attr("data-tag","dt_inner_row_1"),e.data("tag","dt_inner_row_1"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/dt_inner_row_1]"),e.find("> .inside_row >.open-tag.render-tag").html(n)):(e.find(">.close-tag.render-tag").html("[/dt_inner_row_1]"),e.find(">.open-tag.render-tag").html(n)),i.attr("data-tag","dt_inner_column_1"),i.data("tag","dt_inner_column_1"),i.find(">.close-tag.render-tag").html("[/dt_inner_column_1]"),i.find(">.open-tag.render-tag").html(a);var o=i.find(">.element-content >.element-row");o.length&&c(o)}}else{var i=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.column-container >.element-column"):e.find(">.column-container >.element-column"),n=e.hasClass("element-row")&&e.find("> .inside_row").length?e.find("> .inside_row >.open-tag.render-tag"):e.find(">.open-tag.render-tag");n=n.html().replace("dt_inner_row_1","dt_inner_row").replace("dt_inner_row","dt_row");var a=i.find(">.open-tag.render-tag").html().replace("dt_inner_column_1","dt_inner_column").replace("dt_inner_column","dt_column");e.attr("data-tag","dt_row"),e.data("tag","dt_row"),e.hasClass("element-row")&&e.find("> .inside_row").length?(e.find("> .inside_row >.close-tag.render-tag").html("[/dt_row]"),e.find("> .inside_row >.open-tag.render-tag").html(n)):(e.find(">.close-tag.render-tag").html("[/dt_row]"),e.find(">.open-tag.render-tag").html(n)),i.attr("data-tag","dt_column"),i.data("tag","dt_column"),i.find(">.close-tag.render-tag").html("[/dt_column]"),i.find(">.open-tag.render-tag").html(a);var o=i.find(">.element-content >.element-row");o.length&&c(o)}}function m(t,i,n){if(i!=n){var a=t.find("> .inside_row > .column-container"),o=a.find("> .element-column"),l="12"!=i?i.split(" ",12):new Array("12"),d=l.length,s="12"!=n?n.split(" ",12):new Array("12"),c=s.length;if(o.length){o.each(function(t,i){e(i).removeClass(function(e,t){for(var i="",n=t.split(" "),a=0;a<n.length;a++)/col-\d{1,3}/.test(n[a])&&(i+=n[a]+" ");return i})});var m=a.width(),u=m/12;if(d>c){var h=d-c,p=a.find("> .element-column:last");try{p.resizable("enable")}catch(v){}for(var _=0;h>_;_++){var g=p.clone(!1);e(".ui-resizable-handle",g).remove(),g.find("> .element-content").html(""),a.append(g)}var o=a.find("> .element-column");o.each(function(t,i){var n=100*(l[t]*u/m);e(i).addClass("col-"+l[t]).data("column",l[t]).attr("data-column",l[t]),e(i).outerWidth(n+"%"),f(i)}),a.find(".dropable-element").sortable({cursor:"move",connectWith:".dropable-element,.dt-editor-work",handle:">.element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){if(!t.item.is(".element-row")&&t.item.parent().is(".dt-editor-work"))return!1;var i=t.item.find("> .element-holder.dragger");i.removeClass("dragger").html('<i title="'+C.move_this_element+'" class="flaticon-pointer2"></i>'),r()},over:function(e,t){return!t.item.is(".element-row")&&t.placeholder.parent().is(".dt-editor-work")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):(t.placeholder.removeClass("sortable-placeholder-hidden"),void 0)}})}else c>d?(o.find("> .element-content"),o.each(function(t,i){if(d>t){var n=100*(l[t]*u/m);e(i).addClass("col-"+l[t]).data("column",l[t]).attr("data-column",l[t]),e(i).outerWidth(n+"%"),d-1==t&&e(i).resizable("disable")}else{var o=e(i).find("> .element-content");a.find("> .element-column:first > .element-content").append(o.children()),e(i).remove()}})):o.each(function(t,i){var n=100*(l[t]*u/m);e(i).addClass("col-"+l[t]).data("column",l[t]).attr("data-column",l[t]),e(i).outerWidth(n+"%")});t.data("column",i),t.attr("data-column",i),b(),r()}}}function u(){var t=e(".dt-editor-work");t.sortable({connectWith:".element-column > .dropable-element,.dt-editor-work,.dt-editor-work .element-container > .dropable-element",cursor:"move",handle:"> .element-toolbar .element-holder, > .inside_row > .element-toolbar .element-holder, > .element-holder, > .element-toolbar .element-holder",forcePlaceholderSize:!0,tolerance:"pointer",distance:0,stop:function(e,t){return!t.item.is(".element-row")&&t.item.parent().is(".dt-editor-work")?!1:(t.item.is(".element-row")&&c(t.item),s(),b(),r(),void 0)},over:function(e,t){return!t.item.is(".element-row")&&t.placeholder.parent().is(".dt-editor-work")?(t.placeholder.addClass("sortable-placeholder-hidden"),!1):(t.placeholder.removeClass("sortable-placeholder-hidden"),void 0)}}),d(),s(),b(),l(),v();var i=e(".add-page-shortcode");i.click(function(t){t.preventDefault(),null===document.getElementById("TB_new_overlay")&&(e("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),e("#TB_new_overlay").click(w),e("body").addClass("modal-open"));var i=e("#TB_new_window"),n=e("<form id='asTB_content' method='post'></form>"),a=e('<a id="cancel_shortcode_module" href="#"></a>').text(C.close),o=e('<a id="save_shortcode_module" href="#"></a>').text(C.save),m=e('<textarea class="custom_css_editor_area" name="custom_css"></textarea>'),u=e("<div id='TB_bottom'></div>").append(o,a),h="";i.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.add_shortcode_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),i.append(n,u),e("#asasTB_closeWindowButton").click(w),n.append(m),i.css({visibility:"visible"}),a.click(w),o.click(function(t){return t.preventDefault(),h=m.val(),h.match(/^\[dt_(\w?){0,}row.*?\]/)||(h.match(/\]$/)&&h.match(/^\[.*/)||(h="[dt_text_html]"+h+"[/dt_text_html]"),h='[dt_row][dt_column column="12"]'+h+"[/dt_column][/dt_row]"),""==h?w():(e.ajax({type:"POST",url:ajaxurl,data:{action:"detheme_add_shortcode",shortcode:h},dataType:"html",context:this}).done(function(t){var i=e(".dt-editor-work"),n=e(t);1==i.find(".dropable-element").length&&""==i.find(".dropable-element").text()?i.html(n):i.append(n);var a=i.find("> .element-row");a.length?c(a):(a=i.find(".element-row"),a.length&&c(a)),l(),s(),v(),d(),b(),r(),w()}),void 0)})})}function h(e,t){var i=Math.round(12*(e/t));return i}function p(t){var i=0,n=t.find("> .element-builder:NOT(.ui-resizable-adjust)");return n.length?(n.each(function(t,n){i+=e(n).outerWidth(!0)}),i):i}function f(t){e(t).resizable({handles:"e",minWidth:10,create:function(){var t=e(this).next();t.length||e(this).resizable("disable")},resize:function(e,t){var i=t.helper.outerWidth(!0),n=t.helper.next();t.helper.prev();var a=t.helper.parent();n.addClass("ui-resizable-adjust"),t.helper.addClass("ui-resizable-adjust");var o=p(a),r=a.width(),l=r/12;t.size.width<=l&&(t.size.width=i=l);var d=r-o-i;l>=d&&(t.size.width=r-o-l,d=l),n.outerWidth(d-1)},stop:function(e,t){t.helper.siblings().removeClass("ui-resizable-adjust"),t.helper.removeClass("ui-resizable-adjust");var i=t.helper.parent(),n=i.width(),a=n/12,o=t.helper.next(),l=h(t.size.width,n),d=h(o.outerWidth(),n),s=100*(l*a/n),c=100*(d*a/n);t.helper.outerWidth(s+"%"),t.helper.data("column",l),t.helper.attr("data-column",l),o.outerWidth(c+"%"),o.data("column",d),o.attr("data-column",d),r()}})}function v(){e(".dt-editor-work .element-builder.element-column").each(function(e,t){f(t)})}function g(){var t=e("#dtbuilder_custom_css_edit"),i=e("#dtbuilder_custom_css_field");t.click(function(t){t.preventDefault(),null===document.getElementById("TB_new_overlay")&&(e("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),e("#TB_new_overlay").click(w),e("body").addClass("modal-open"));var n=e("#TB_new_window"),a=e("<form id='asTB_content' method='post'></form>"),o=e('<a id="save_shortcode_module" href="#"></a>').text(C.save),r=e('<a id="cancel_shortcode_module" href="#"></a>').text(C.cancel),l=e('<textarea class="custom_css_editor_area" name="custom_css"></textarea>'),d=e("<div id='TB_bottom'></div>").append(o,r),s=i.val();l.val(s),n.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.custom_css_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),n.append(a,d),e("#asasTB_closeWindowButton").click(w),a.append(l),n.css({visibility:"visible"}),r.click(w),o.click(function(e){e.preventDefault(),s=l.val(),i.val(s),w()})})}function w(){return e(".html-editor").length&&"undefined"!=typeof tinyMCE&&e(".html-editor").each(function(){var t=e(this),i=t.attr("id");tinymce.execCommand("mceRemoveEditor",!0,i)}),e("#TB_imageOff").unbind("click"),e("#TB_closeWindowButton").unbind("click"),e("#TB_new_window").fadeOut("fast",function(){e("#TB_new_window,#TB_new_overlay,#TB_HideSelect").trigger("tb_unload").unbind().remove()}),e("body").removeClass("modal-open"),e("#TB_load").remove(),e("#TB_load").remove("modal-open"),e("body").removeClass(""),"undefined"==typeof document.body.style.maxHeight&&(e("body","html").css({height:"auto",width:"auto"}),e("html").css("overflow","")),e(document).unbind(".thickbox"),!1}function b(){e(".element-builder .builder_handlediv").unbind("click").click(function(t){var i=e(this),n=i.closest(".element-builder");t.preventDefault(),n.toggleClass("closed")}),e(".element-builder .element-setting a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder"),a=i.parent().data("title"),o=Math.floor(-999998*Math.random()+1e6)+(new Date).getTime(),l=n.data("tag"),d=n.hasClass("element-row")?n.find("> .inside_row > .open-tag.render-tag"):n.find("> .open-tag.render-tag"),s=n.hasClass("element-row")?n.find("> .inside_row > .content-tag.render-tag"):n.find("> .content-tag.render-tag"),c=n.find("> .element-preview"),m=n.hasClass("element-row")?n.find("> .inside_row > .close-tag.render-tag"):n.find("> .close-tag.render-tag"),u="";null===document.getElementById("TB_new_overlay")&&(e("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),e("#TB_new_overlay").click(w),e("body").addClass("modal-open"));var h=e("#TB_new_window"),p=e("<form id='asTB_content' class='setting-element-"+l+"' method='post'></form>"),f=e('<a id="save_shortcode_module" href="#"></a>').text(C.save),v=e('<a id="cancel_shortcode_module" href="#"></a>').text(C.cancel),_=e("<div id='TB_bottom'></div>").append(f,v);h.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.edit_title_panel+" "+a+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),h.append(p,_),e("#asasTB_closeWindowButton").click(w),u=d.text()+s.text()+m.text(),e.ajax({type:"POST",url:ajaxurl,data:{action:"detheme_builder_setting",tag:l,identified:o,shortcode:u},dataType:"html",context:this}).done(function(t){p.append(e(t)),e(document).trigger("loaded")}),h.css({visibility:"visible"}),v.click(w),f.click(function(t){t.preventDefault(),e(".html-editor").length&&"undefined"!=typeof tinymce&&e(".html-editor").each(function(){var t,i=e(this),n=i.attr("id"),a=i.closest(".wp-editor-wrap");a.is(".tmce-active")&&(t=tinymce.get(n).getContent(),i.val(t)),"4"===tinymce.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,n):window.tinyMCE.execCommand("mceRemoveControl",!0,n)});var i=p.serializeArray();e.ajax({type:"POST",url:ajaxurl,data:{action:"detheme_save_setting",tag:l,identified:o,shortcode:i},dataType:"html",context:this}).done(function(t){var i=e("<div>"+t+"</div>"),n=e(".shorcode_tag",i),a=e(".shorcode_content",i).html(),o=e(".shorcode_preview",i);d.html(n.html()),s.text(a),c&&c.html(o.html()),r(),w()})});var g=!1,b=!1,y=!1,k=17,T=88,B=83,x=16,E=18;e(document).unbind("keydown").unbind("keyup").keydown(function(e){e.keyCode==k&&(g=!0),e.keyCode==x&&(b=!0),e.keyCode==E&&(y=!0),g&&y&&e.keyCode==T&&w(),g&&y&&e.keyCode==B&&f.click()}).keyup(function(e){e.keyCode==k&&(g=!1),e.keyCode==x&&(b=!1),e.keyCode==E&&(y=!1)})}),e(".element-builder .element-addshortcode a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder");null===document.getElementById("TB_new_overlay")&&(e("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),e("#TB_new_overlay").click(w),e("body").addClass("modal-open"));var a=e("#TB_new_window"),o=e("<form id='asTB_content' method='post'></form>"),m=e('<a id="cancel_shortcode_module" href="#"></a>').text(C.close),u=e('<a id="save_shortcode_module" href="#"></a>').text(C.save),h=e('<textarea class="custom_css_editor_area" name="custom_css"></textarea>'),p=e("<div id='TB_bottom'></div>").append(u,m),f="";a.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.add_shortcode_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),a.append(o,p),e("#asasTB_closeWindowButton").click(w),o.append(h),a.css({visibility:"visible"}),m.click(w),u.click(function(t){return t.preventDefault(),f=h.val(),""==f?w():(e.ajax({type:"POST",url:ajaxurl,data:{action:"detheme_add_shortcode",shortcode:f},dataType:"html",context:this}).done(function(t){var i=n.find("> .element-content"),a=e(t);i.append(a);var o=i.find("> .element-row");o.length?c(o):(o=i.find(".element-row"),o.length&&c(o)),l(),s(),v(),d(),b(),r(),w()}),void 0)})}),e(".element-builder .element-shortcode a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder");null===document.getElementById("TB_new_overlay")&&(e("body").append("<div id='TB_new_overlay'></div><div id='TB_new_window'></div>"),e("#TB_new_overlay").click(w),e("body").addClass("modal-open"));var a=e("#TB_new_window"),r=e("<form id='asTB_content' method='post'></form>"),l=e('<a id="cancel_shortcode_module" href="#"></a>').text(C.close),d=e('<textarea class="custom_css_editor_area" name="custom_css" readonly="readonly"></textarea>'),s=e("<div id='TB_bottom'></div>").append(l),c=o(n);d.val(c),a.append("<div id='asasTB_title'><div id='asasTB_ajaxWindowTitle'>"+C.show_shortcode_title+"</div><div id='asasTB_closeAjaxWindow'><a href='#' id='asasTB_closeWindowButton' title='"+C.close+"'><div class='tb-close-icon'></div></a></div></div>"),a.append(r,s),e("#asasTB_closeWindowButton").click(w),r.append(d),a.css({visibility:"visible"}),l.click(w)}),e(".select-column").unbind("click").click(function(){var t=e(this).closest(".toolbar").find(".option-column-group"),i=e(this);t.toggleClass("buka"),i.toggleClass("muncul"),e("body").click(function(n){e(n.target).is(t)||t.has(n.target).length||i.has(n.target).length||(t.removeClass("buka"),i.removeClass("muncul"))})}),e(".option-column-group .option-column a").unbind("click").click(function(t){t.preventDefault();var i=e(this).closest(".element-builder.element-row"),n=e(this).data("column"),a=i.data("column"),o=e(this).closest(".option-column-group");if(e(this).is(".column_custom")){if(e(".option-custom",o).length){var r=e(".option-custom");r.show()}else{var r=e("<li></li>").addClass("option-custom"),l=e('<a href="#" class="cancelColumn">'+C.cancel+"</a>"),d=e('<a href="#" class="saveColumn">'+C.save+"</a>"),c=e('<input type="text" name="columnTo" placeholder="'+C.custom_column_placeholder+'" value="" />');r.append(c,d,l),o.append(r),l.click(function(e){e.preventDefault(),r.hide({duration:100,complete:function(){o.removeClass("buka")}})}),d.click(function(e){e.preventDefault();var t=c.val(),n=i.data("column");m(i,t,n),s(),v(),r.hide({duration:100,complete:function(){o.removeClass("buka"),c.val("")}})}),c.on("keyup",function(){var t=0,i=e(this).val().split(" ",12);e.each(i,function(e,i){t+=parseInt(i)}),12==t?d.show():d.hide()}),c.on("keypress",function(t){if(13==t.which){t.preventDefault();var t=0,i=e(this).val().split(" ",12);e.each(i,function(e,i){t+=parseInt(i)}),12==t&&d.trigger("click")}}),c.trigger("keyup")}e('input[name="columnTo"]',o).focus()}else o.removeClass("buka"),m(i,n,a),s()}),e(".element-builder .element-delete a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder"),a=confirm(C.are_you_sure_delete_confirmation);a===!0&&(n.remove(),r())}),e(".element-builder .element-delete-column a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder");if(!n.siblings().length)return alert(C.column_canot_delete);var a=confirm(C.are_you_sure_delete_column_confirmation),o=n.next(),l=n.prev(),d=n.parent(),s=d.closest(".element-builder.element-row"),c=parseInt(n.data("column"));if(a===!0){if(l.length){var m=parseInt(l.data("column")),u=m+c;l.data("column",u),l.attr("data-column",u);var h=100*(u/12);l.outerWidth(h+"%")}else{if(!o.length)return;var p=parseInt(o.data("column")),f=p+c;o.data("column",f),o.attr("data-column",f);var v=100*(f/12);o.outerWidth(v+"%")}n.remove();var _=s.find("> .inside_row > .column-container >.element-column");if(_.length){var g=[],w=0,b="12";_.each(function(t,i){var n=parseInt(e(i).data("column"));w+=n,g.push(n)}),12==w&&(b=g.join(" ",g)),s.data("column",b),s.attr("data-column",b)}r()}}),e(".element-builder .element-copy a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder"),a=n.clone(!1);e(".ui-resizable-handle",a).remove(),n.after(a),l(),s(),v(),d(),b(),r()}),e(".element-builder .element-up a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder");n.parent();var a=n.prev(),o=n.outerHeight(!0);a.length&&(a.before(n),r(),e(document).scrollTop(e(document).scrollTop()-o-20))}),e(".element-builder .element-down a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder");n.parent();var a=n.next(),o=n.outerHeight(!0);a.length&&(a.after(n),r(),e(document).scrollTop(e(document).scrollTop()+o+20))}),e(".dt-editor-work .children-toolbar a").unbind("click").click(function(t){t.preventDefault();var i=e(this),n=i.closest(".element-builder"),a=e("> .element-content",n),o=i.data("child"),l=e(".element-builders").find('.element-builder[data-tag="'+o+'"]');if(l.length){var d=l.clone(!0);a.append(d.show()),r(),d.hasClass("show-create")&&d.find(".element-setting a").click()}}),e(".dt-editor-work .element-row").length&&e(".dt-editor-work .element-row").each(function(){var t=e(this),i="12",n=t.find("> .inside_row > .column-container >.element-column");if(n.length){var a=[],o=0;n.each(function(t,i){var n=parseInt(e(i).data("column"));o+=n,a.push(n)}),12==o&&(i=a.join(" ",a))}t.data("column",i)})}function y(e,t,i){var n;if(i){var a=new Date;a.setTime(a.getTime()+1e3*60*60*24*i),n="; expires="+a.toGMTString()}else n="";document.cookie=escape(e)+"="+escape(t)+n+"; path=/"}function k(e){for(var t=escape(e)+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var a=i[n];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return unescape(a.substring(t.length,a.length))}return null}Color.prototype.toString=function(e){if("no-alpha"==e)return this.toCSS("rgba","1").replace(/\s+/g,"");if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var t=parseInt(this._color,10).toString(16);if(this.error)return"";if(t.length<6)for(var i=6-t.length-1;i>=0;i--)t="0"+t;return"#"+t};var C=window.dtb_i18nLocale;wp.media.BuilderImageEdit={getData:function(){return this.formfield.val()},set:function(t){this.preview.html("");var i=e("<div></div>").addClass("preview-image"),a=e('<a><div class="dashicons dashicons-no-alt"></div></a>').addClass("remove_field_image"),o=e('<img data-id="'+t.get("id")+'" src="'+t.attributes.url+'"/>');return i.append(o),a.click(n),i.append(a),this.preview.append(i),this.formfield.val(t.get("id")).trigger("change"),!1},frame:function(t){var i=(t.find(".add_field_image"),t.find(".remove_field_image")),a=(t.find("input"),t.find(".preview-images"));return t.find(".preview-image"),a.length||(a=e("<div></div>").addClass("preview-images"),t.prepend(a)),this.field=t,this.formfield=t.find("input"),this.preview=a,i.click(n),this._frame?this._frame:(this._frame=wp.media({id:"dt_builder",state:"insert-image",title:C.insert_image,editing:!0,multiple:!1,toolbar:"insert-image",menu:"insert-image",type:"image",states:[new wp.media.controller.BuilderImageEdit]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.insert_image})},this._frame),this._frame.state("insert-image").on("select",this.select),this._frame)},select:function(){var e=this.get("selection").single();wp.media.BuilderImageEdit.set(e?e:-1)}},wp.media.controller.BuilderImageEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:!1,toolbar:"insert-image",library:wp.media.query({type:"image"}),title:C.select_image,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e,t=this.get("selection"),i=wp.media.BuilderImageEdit.getData();""!==i&&-1!==i&&(e=wp.media.model.Attachment.get(i),e.fetch()),t.reset(e?[e]:[])}}),wp.media.controller.BuilderImagesEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:"add",library:wp.media.query({type:"image"}),toolbar:"insert-image",title:C.select_image,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e,t=this.get("selection");wp.media.BuilderImagesEdit.getData(),t.reset(e)}}),wp.media.BuilderImagesEdit={getData:function(){return this.formfield.val()},set:function(t){var i=this,a=this.formfield.val(),o=""!=a?a.split("/,/"):[];return t.map(function(t){t=t.toJSON(),o.push(t.id);var a=e("<div></div>").addClass("preview-image"),r=e('<a><div class="dashicons dashicons-no-alt"></div></a>').addClass("remove_field_image");a.append(e('<img data-id="'+t.id+'" src="'+t.url+'"/>')),r.click(n),a.append(r),i.preview.append(a)}),this.formfield.val(o.join(",")).trigger("change"),!1},frame:function(e){var t=(e.find("input"),e.find(".preview-images"));return this.formfield=e.find("input"),this.preview=t,this._frame?this._frame:(this._frame=wp.media({id:"dt_builder",state:"insert-image",title:C.insert_image,editing:!0,multiple:!0,toolbar:"insert-image",type:"image",states:[new wp.media.controller.BuilderImagesEdit]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.insert_image})},this._frame),this._frame.state("insert-image").on("select",this.select),this._frame)},select:function(){var e=this.get("selection");wp.media.BuilderImagesEdit.set(e?e:-1)}},wp.media.BuilderVideoEdit={getData:function(){return this.formfield.val()},set:function(t){if(this.getData()==t.get("id"))return!1;var i=e('<video autoplay data-id="'+t.get("id")+'" width="266"/>'),n=e("<source/>"),a=t.attributes.mime,o=t.attributes.thumb.src;return n.attr("src",t.attributes.url),n.attr("type",a),i.attr("poster",o),i.append(n),this.preview.find("a.add_field_video").html(i),this.formfield.val(t.get("id")).trigger("change"),this.field.find(".remove_attach_video").show(),!1},frame:function(e){var t=(e.find(".add_field_video"),e.find(".remove_attach_video")),n=(e.find("input"),e.find(".preview-video"));return this.field=e,this.formfield=e.find("input"),this.preview=n,t.click(i),this._frame?this._frame:(this._frame=wp.media({id:"detheme_video",state:"insert-image",title:C.insert_video,editing:!0,multiple:!1,toolbar:"insert-image",menu:"insert-image",type:"image",states:[new wp.media.controller.BuilderVideoEdit({library:wp.media.query({type:"video/mp4,video/webm"})})]}),this._frame.on("toolbar:create:insert-image",function(e){this.createSelectToolbar(e,{text:C.select_video})},this._frame),this._frame.state("insert-image").on("select",this.select),this._frame)},select:function(){var e=this.get("selection").single();wp.media.BuilderVideoEdit.set(e?e:-1)}},wp.media.controller.BuilderVideoEdit=wp.media.controller.FeaturedImage.extend({defaults:_.defaults({id:"insert-image",filterable:"uploaded",multiple:!1,toolbar:"insert-image",library:wp.media.query({type:"video"}),title:C.select_video,priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),updateSelection:function(){var e,t=this.get("selection"),i=wp.media.BuilderVideoEdit.getData();""!==i&&-1!==i&&(e=wp.media.model.Attachment.get(i),e.fetch()),t.reset(e?[e]:[])}}),e(document).on("loaded",function(){function o(){var i=e("#asTB_content"),n=e(".param_value",i);n.length&&(n.each(function(){var t=e(this),n={};if(t.data("dependent")&&t.data("dependvalue")){n.dependency=t.attr("name"),n.dependency_value=t.data("dependvalue").toString();var a=e('[name="'+t.data("dependent")+'"]',i),o=a.data("param")?a.data("param"):[];o.push(n),a.data("param",o)}}),n.each(function(){e(this).on("change keyup",function(n){if("object"==typeof e(this).data("param")){var a=e(this).data("param");for(var n in a){var o=a[n],r="not_empty"==o.dependency_value?!0:!1,l=r?new Array("not_empty"):o.dependency_value.split(","),d=e('[name="'+o.dependency+'"]',i),s=d.closest(".field-wrap");r&&""!=e(this).val()?s.show():t(e(this).val(),l)?s.show():s.hide()}}}).trigger("change")}))}e(".html-editor").length&&"undefined"!=typeof tinyMCE&&(window.switchEditors.go("content","tmce"),e(".html-editor").each(function(){a(this)})),e(".field-image").length&&e(".field-image").each(function(){var t=e(this);t.find(".add_field_image").unbind("click").click(function(){e(this).is(".multi-image")?wp.media.BuilderImagesEdit.frame(t).open():wp.media.BuilderImageEdit.frame(t).open()
}),t.find(".remove_field_image").unbind("click").click(n)}),e(".field-video").length&&e(".field-video").each(function(){var t=e(this);t.find(".add_field_video").unbind("click").click(function(){wp.media.BuilderVideoEdit.frame(t).open()}),t.find(".remove_attach_video").unbind("click").click(i)}),e(".radio-options").length&&e(".radio-options").each(function(){var t=e(this),i=e(".radio-option",t),n=e("input.radio-input-value",t);i.on("change",function(){n.val(e(this).val()).trigger("change")})}),e(".checkbox-options").length&&e(".checkbox-options").each(function(){var t=e(this),i=e(".checkbox-option",t),n=e("input.checkbox-input-value",t);i.on("change",function(){var t=[];i.each(function(){e(this).prop("checked")&&t.push(e(this).val())}),n.val(t.join(","))})}),e(".dt-color-picker").length&&e(".dt-color-picker").each(function(){var t,i,n=e(this),a=e(this).data("palletes"),o=n.val().replace(/\s+/g,"");if(o.match(/rgba\(\d+\,\d+\,\d+\,([^\)]+)\)/))var t=100*parseFloat(o.match(/rgba\(\d+\,\d+\,\d+\,([^\)]+)\)/)[1]),t=parseInt(t);else var t=100;if("false"==a||0==a)var r=!1;else if("true"==a||1==a)var r=!0;else var r=n.data("palletes").split(",");n.wpColorPicker({palettes:r,clear:function(){i.find('[name="alpha"]').val(100),d.val("100%")}});var i=n.closest(".wp-picker-container").addClass("dt_color_picker").find(".iris-picker").addClass("has-alpha"),l=e('<div class="alpha-container">Alpha: <output class="rangevalue">'+t+'%</output><input type="range" min="1" max="100" value="100" name="alpha" class="alpha-field"></div>');i.append(l);var d=i.find(".alpha-container output");i.find('[name="alpha"]').bind("change keyup",function(){var t,i=e(this),a=parseFloat(i.val()),o=n.data("a8cIris");n.data("wpWpColorPicker"),d.val(a+"%"),o._color._alpha=a/100,n.val(o._color.toString()),t=n.val(),e(n).wpColorPicker("color",t)}).val(t).trigger("change")}),e(".option-select").length&&e(".option-select").each(function(){var t=e(this),i=e("input",t);e(".layout-option",t).click(function(){i.val(e(this).data("option")),e(".layout-option",t).removeClass("active"),e(this).addClass("active"),i.trigger("change")})}),e(".input-slider").length&&e(".input-slider").each(function(){var t=e(this),i=t.closest(".input-slider-container").find("input");t.on("change",function(){t.slider({value:i.val(),min:t.data("min"),max:t.data("max"),step:t.data("step"),slide:function(e,t){i.val(t.value).trigger("change")}})}).trigger("change"),i.on("keyup",function(){e(this).val()>t.data("max")&&e(this).val(t.data("max")),t.slider({value:e(this).val()}),e(this).trigger("change")})}),o()});var T=e('<div class="editor-switch-container"/>'),B=e('<a class="button switch-editor" href="javascript:;">deTheme Editor</a>'),x=e("#postdivrich"),E=e("#dtbuilder");T.insertAfter("div#titlediv"),B.appendTo(T);var I=k("_hide_editor");E.hide(),"hide"!=I&&(E.show({complete:function(){e("#dtduilder_wrap").show(),E.removeClass("closed"),B.text(C.classic_editor)}}),x.hide()),B.click(function(){x.toggle(),x.is(":visible")?(E.hide(),B.text("deTheme Editor"),y("_hide_editor","hide")):(E.show({complete:function(){e("#dtduilder_wrap").show(),B.text(C.classic_editor)}}),y("_hide_editor","show"))}),e(".element-builders .element-row").draggable({connectToSortable:".dt-editor-work",helper:"clone",cursor:"move",handle:">.element-holder",drag:function(e,t){t.helper.width(400)},stop:function(t,i){i.helper.width("auto"),i.helper.height("auto"),i.helper.wrapInner(e('<div class="inside_row"></div>')),i.helper.prepend(e('<div class="builder_handlediv" title="'+C.click_to_toggle+'"></div><h3 class="row-title">'+C.row+"</h3>")),s(),b()}}),e(".element-builders .element-frebase").draggable({connectToSortable:".element-column >.dropable-element,.element-container > .dropable-element",cursor:"move",helper:"clone",handle:">.element-holder",start:function(){},drag:function(e,t){t.helper.width(100)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),b(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),e(".element-builders .element-container").draggable({connectToSortable:".element-column > .dropable-element,.element-container > .dropable-element",helper:"clone",cursor:"move",handle:">.element-holder",start:function(){},drag:function(e,t){t.helper.width(400)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),d(),b(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),e(".element-builders .element-parent").draggable({connectToSortable:".element-column > .dropable-element",helper:"clone",cursor:"move",handle:">.element-holder",start:function(){},drag:function(e,t){t.helper.width(400)},stop:function(e,t){t.helper.width("auto"),t.helper.height("auto"),l(),b(),t.helper.hasClass("show-create")&&t.helper.find(".element-setting a").click()}}),u(),g(),e(window).resize(function(){e(document).scroll()}),e(document).scroll(function(){var t=e("#dtbuilder"),i=e(window).scrollTop(),n=e(".element-builders",t),a=e("#submitdiv"),o=e("#major-publishing-actions"),r=t.offset().top,l=2,d=t.width()-12,s=a.offset().top;e("#wpadminbar").length&&(l=e("#wpadminbar").outerHeight()),i+20>r+12.5?(n.addClass("make-stciky"),n.css({top:l,width:d})):n.removeClass("make-stciky"),a.hasClass("closed")||(s+=a.find(".inside").outerHeight(!0)),i+l+27>s?(o.addClass("make-stciky"),o.css({top:l})):o.removeClass("make-stciky")})});